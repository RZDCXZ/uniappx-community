{"version":3,"sources":["pages/user-feedback-form/user-feedback-form.uvue","components/article-list-item/article-list-item.uvue","components/topic-list-item/topic-list-item.uvue","common/socket.uts","pages/user-feedback-form/user-feedback-form.uvue?type=page"],"sourcesContent":["<template>\r\n\t<navbar type=\"text\" title=\"意见反馈\">\r\n\t\t<template #right>\r\n\t\t\t<view class=\"navbar-right\">\r\n\t\t\t\t<main-btn :disabled=\"disabled\" width=\"138rpx\" height=\"60rpx\" font-size=\"14px\" @click=\"submit\">提交反馈</main-btn>\r\n\t\t\t</view>\r\n\t\t</template>\r\n\t</navbar>\r\n\r\n\t<scroll-view style=\"flex:1;background-color: #f4f4f4;\">\r\n\r\n\t\t<view style=\"background-color: #ffffff;\">\r\n\t\t\t<textarea :auto-focus=\"true\" :auto-height=\"true\" v-model=\"content\" placeholder=\"请说明具体问题(300字以内)~\" class=\"add-textarea\"></textarea>\t\r\n\t\t\t<upload-images ref=\"upload\" style=\"margin-bottom: 60rpx;\"></upload-images>\r\n\t\t\t\r\n\t\t</view>\r\n\t\t\r\n\r\n\t</scroll-view>\r\n\r\n</template>\r\n\r\n<script>\r\n\timport { defaultResult } from \"@/common/type.uts\"\r\n\timport { getURL } from \"@/common/request.uts\"\r\n\timport { getToken } from \"@/store/user.uts\"\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcontent:\"\",\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tdisabled(): boolean {\r\n\t\t\t\treturn this.content.length == 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsubmit(){\r\n\t\t\t\t// 拿到上传组件节点\r\n\t\t\t\tconst uploadRef = this.$refs[\"upload\"] as ComponentPublicInstance\r\n\t\t\t\t// 判断是否还有图片正在上传\r\n\t\t\t\tif(uploadRef.$callMethod(\"isUploading\") as boolean){\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '还有图片正在上传中...',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 获取图片数组\r\n\t\t\t\tlet images = uploadRef.$callMethod(\"getValue\") as string[]\r\n\t\t\t\t// 请求参数\r\n\t\t\t\tlet data = {\r\n\t\t\t\t  images,\r\n\t\t\t\t  content:this.content\r\n\t\t\t\t} as  UTSJSONObject\r\n\t\t\t\t\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '提交中...',\r\n\t\t\t\t\tmask: false\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tuni.request<defaultResult>({\r\n\t\t\t\t\turl: getURL(\"/feedback/save\"),\r\n\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\tdata,\r\n\t\t\t\t\theader:{\r\n\t\t\t\t\t\ttoken:getToken()\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tlet r = res.data\r\n\t\t\t\t\t\tif(r == null) return\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 请求失败\r\n\t\t\t\t\t\tif(res.statusCode != 200){\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: r.msg,\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: r.msg,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\t\tdelta: 1\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}, 300);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: err.errMsg,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n.navbar-right {\r\n\theight: 45px;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tmargin-right: 34rpx;\r\n}\r\n.cell-tip {\r\n\tcolor: #f0748a;\r\n\tbackground-color: #fff1f6;\r\n\tborder-radius: 4px;\r\n\tmargin-left: 18rpx;\r\n\tfont-size: 13px;\r\n\tpadding: 5rpx 10rpx;\r\n}\r\n.add-textarea {\r\n\twidth: 750rpx;\r\n\tmax-height: 500rpx;\r\n\tpadding: 60rpx 30rpx;\r\n}\r\n</style>\r\n",null,null,null,null],"names":[],"mappings":";;;;;;;;;;;;;;;;;+BAIiE;+BA+CxD;;+BA2CC;;;;;;;;;;;;YA7FT,YAMS,mBAAA,SAND,UAAK,QAAO,WAAM,kBACd,WAAK,YACf,gBAEO,GAAA;uBAAA;oBAFP,mBAEO,QAAA,SAFD,WAAM,iBAAc;wBACzB,YAA6G,qBAAA,SAAlG,cAAU,KAAA,QAAQ,EAAE,WAAM,UAAS,YAAO,SAAQ,eAAU,QAAQ,aAAO,KAAA,MAAM,qCAAE,gBAAI,GAAA;mCAAA;gCAAJ;6BAAI;;;;;;;;;;YAKrG,mBASc,eAAA,SATD,WAAyC,eAAzC,SAAA,UAAA,KAAA,sBAAA;gBAEZ,mBAIO,QAAA,SAJD,WAAkC,eAAlC,SAAA,sBAAA;oBACL,mBAAkI,YAAA,SAAvH,gBAAY,IAAI,EAAG,iBAAa,IAAI,kBAAW,KAAA,OAAO;wBAAP,KAAA,OAAO,GAAA,SAAA,MAAA,CAAA,KAAA;oBAAA;sBAAE,iBAAY,oBAAmB,WAAM;;;;oBACxG,YAA0E,0BAAA,SAA3D,SAAI,UAAS,WAA6B,eAA7B,SAAA,mBAAA;;;;;;;aAgB3B;uBAIW,OAAM;;;wBAJjB,aAAQ,2BAIG,OAAM,EAAlB,OAAY,OAAM,CAAE;YACnB,OAAO,IAAI,CAAC,OAAO,CAAC,MAAK,IAAK,CAAA;QAC/B;;;;aAGA,SAAA,MAAQ;YAEP,IAAM,YAAY,IAAI,CAAC,OAAK,CAAC,SAAQ,CAAE,EAAC,CAAE;YAE1C,IAAG,UAAU,aAAW,CAAC,eAAe,EAAC,CAAE,OAAO,EAAC;gBAClD,+BACC,QAAO,gBACP,OAAM;gBAEP;YACD;YAEA,IAAI,SAAS,UAAU,aAAW,CAAC,YAAY,EAAC,UAAE,MAAM;YAExD,IAAI,sBAAO;uCAAA,qBAAA,QAAA,oDAAA,EAAA,EAAA,CAAA;oBACT,IAAA,SAAA;oBACA,IAAA,UAAQ,GAAK,OAAM;;aACrB;YAEA,mCACC,QAAO,UACP,OAAM,KAAI;YAGX,0CACC,MAAK,OAAO,mBACZ,SAAQ,QACR,OAAA,MACA,SAAO;gBACN,IAAA,QAAM;aACN,EACD,UAAS,IAAA,IAAO;gBACf,IAAI,IAAI,IAAI,IAAG;gBACf,IAAG,KAAK,IAAI;oBAAE;;gBAGd,IAAG,IAAI,UAAS,IAAK,GAAG,EAAC;oBACxB,+BACC,QAAO,EAAE,GAAG,EACZ,OAAM;oBAEP;gBACD;gBAEA,+BACC,QAAO,EAAE,GAAG,EACZ,OAAM;gBAGP,WAAW,MAAW;oBACrB,qCACC,QAAO,CAAA;gBAET;kBAAG,GAAG;YACP;cACA,OAAM,IAAC,IAAQ;gBACd,+BACC,QAAO,IAAI,MAAM,EACjB,OAAM;YAER;cACA,WAAU,MAAM;gBACf;YACD;;QAEF;;;sBAjEA"}