{"version":3,"sources":["pages/user-login-password/user-login-password.uvue","components/article-list-item/article-list-item.uvue","components/topic-list-item/topic-list-item.uvue","store/user.uts","common/socket.uts","pages/user-login-password/user-login-password.uvue?type=page"],"sourcesContent":["<template>\n\t<navbar></navbar>\r\n\t<view class=\"login-page\">\r\n\t\t<text class=\"login-title\">密码登录</text>\r\n\t\t<!-- 输入框 -->\r\n\t\t<login-input :auto-focus=\"true\" v-model=\"username\" placeholder=\"输入手机号/邮箱\"></login-input>\r\n\t\t<login-input style=\"margin-top: 0;\" v-model=\"password\" type=\"safe-password\" placeholder=\"输入密码\" confirm-type=\"send\" @confirm=\"submit\" btn=\"忘记密码\" @click=\"openForgetPassword\"></login-input>\r\n\t\t\r\n\t\t<!-- 底部 -->\r\n\t\t<view class=\"login-bottom\">\r\n\t\t\t<agreement v-model=\"isagree\"></agreement>\r\n\t\t\t<main-btn :disabled=\"disabled\" borderRadius=\"0\" width=\"750rpx\" height=\"98rpx\" fontSize=\"18px\" @click=\"submit()\">登录</main-btn>\r\n\t\t</view>\r\n\t\t\r\n\t</view>\n</template>\n\n<script>\r\n\timport { getURL } from '@/common/request.uts'\n\timport type { Result,UserDetail } from '@/common/type.uts'\r\n\timport { login } from \"@/store/user.uts\"\n\texport default {\n\t\tdata() {\n\t\t\treturn {\r\n\t\t\t\tusername:\"\",\n\t\t\t\tpassword:\"\",\r\n\t\t\t\tisagree:false\n\t\t\t}\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tdisabled(): boolean {\r\n\t\t\t\treturn this.username.trim().length == 0 || this.password.trim().length == 0\r\n\t\t\t}\r\n\t\t},\n\t\tmethods: {\r\n\t\t\topenForgetPassword(){\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/user-forget-password/user-forget-password',\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsubmit(){\r\n\t\t\t\tif(this.disabled) return\r\n\t\t\t\tif(!this.isagree){\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请先阅读并同意用户协议和隐私政策',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '登录中...',\r\n\t\t\t\t\tmask: false\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\tuni.request<Result<UserDetail>>({\r\n\t\t\t\t\turl: getURL(`/user/login`),\r\n\t\t\t\t\tmethod:\"POST\",\r\n\t\t\t\t\tdata:{\r\n\t\t\t\t\t\tusername:this.username,\r\n\t\t\t\t\t\tpassword:this.password\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\tlet r = res.data\r\n\t\t\t\t\t\tif(r == null) return\r\n\t\t\t\t\t\tif(res.statusCode !=200){\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: r.msg,\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// 处理登录\r\n\t\t\t\t\t\tlogin(r.data as UserDetail)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tuni.navigateBack({\r\n\t\t\t\t\t\t\tdelta: 2\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\ttitle: '登录成功',\r\n\t\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}, 200);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (err) => {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: err.errMsg,\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: () => {\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style>\n\n</style>\n",null,null,null,null,null],"names":[],"mappings":";;;;;;;;;;;;;;;;;;+BA8CO;;;+BA2CC;;;;;;;;;;;;;YAxFP,YAAiB;YACjB,mBAYO,QAAA,SAZD,WAAM,eAAY;gBACvB,mBAAqC,QAAA,SAA/B,WAAM,gBAAc;gBAE1B,YAAwF,wBAAA,SAA1E,gBAAY,IAAI,kBAAW,KAAA,QAAQ;oBAAR,KAAA,QAAQ,GAAA;gBAAA;kBAAE,iBAAY;;;;gBAC/D,YAA0L,wBAAA,SAA7K,WAAsB,eAAtB,SAAA,gBAAA,uBAAgC,KAAA,QAAQ;oBAAR,KAAA,QAAQ,GAAA;gBAAA;kBAAE,UAAK,iBAAgB,iBAAY,QAAO,kBAAa,QAAQ,eAAS,KAAA,MAAM,EAAE,SAAI,QAAQ,aAAO,KAAA,kBAAkB;;;;;;;gBAG1K,mBAGO,QAAA,SAHD,WAAM,iBAAc;oBACzB,YAAyC,sBAAA,yBAArB,KAAA,OAAO;wBAAP,KAAA,OAAO,GAAA;oBAAA;;;;;oBAC3B,YAA6H,qBAAA,SAAlH,cAAU,KAAA,QAAQ,EAAE,kBAAa,KAAI,WAAM,UAAS,YAAO,SAAQ,cAAS,QAAQ,aAAK,KAAA;wBAAE,KAAA,MAAM;oBAAA;yDAAI,gBAAE,GAAA;+BAAA;4BAAF;yBAAE;;;;;;;;;;aAajH;aACA;aACA;uBAIW,OAAM;;;wBANjB,cAAS,IACT,cAAS,IACT,aAAQ,KAAI,yBAID,OAAM,EAAlB,OAAY,OAAM,CAAE;YACnB,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,MAAK,IAAK,CAAA,IAAK,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,MAAK,IAAK,CAAA;QAC3E;;;;aAGA,qBAAA,MAAoB;YACnB,iCACC,MAAK;QAEP;;aACA,SAAA,MAAQ;YACP,IAAG,IAAI,CAAC,QAAQ;gBAAE;;YAClB,IAAG,CAAC,IAAI,CAAC,OAAO,EAAC;gBAChB,+BACC,QAAO,oBACP,OAAM;gBAEP;YACD;YACA,mCACC,QAAO,UACP,OAAM,KAAI;YAGX,+CACC,MAAK,OAAQ,gBACb,SAAO,QACP,OAAK;;oBACJ,IAAA,WAAS,GAAK,QAAQ;oBACtB,IAAA,WAAS,GAAK,QAAO;;aACrB,EACD,UAAS,IAAA,IAAO;gBACf,IAAI,IAAI,IAAI,IAAG;gBACf,IAAG,KAAK,IAAI;oBAAE;;gBACd,IAAG,IAAI,UAAS,IAAI,GAAG,EAAC;oBACvB,+BACC,QAAO,EAAE,GAAG,EACZ,OAAM;oBAEP;gBACD;gBAGA,MAAM,EAAE,IAAG,CAAE,EAAC;gBAEd,qCACC,QAAO,CAAA;gBAER,WAAW,MAAW;oBACrB,+BACC,QAAO,QACP,OAAM;gBAER;kBAAG,GAAG;YACP;cACA,OAAM,IAAC,IAAQ;gBACd,+BACC,QAAO,IAAI,MAAM,EACjB,OAAM;YAER;cACA,WAAU,MAAM;gBACf;YACD;;QAEF;;;sBA5DA;sBAKA"}